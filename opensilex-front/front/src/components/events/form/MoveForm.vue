<template>
    <ValidationObserver ref="validatorRef">

        <p><b> {{ $t("Move.location") }}</b></p>
        <hr/>

        <div class="row">
            <div class="col-lg-5">
                <opensilex-InfrastructureFacilitySelector
                        label="Position.from"
                        :facilities.sync="form.from"
                        :multiple="false"
                        :required="false"
                        helpMessage="Position.from-help"
                ></opensilex-InfrastructureFacilitySelector>
            </div>
            <div class="col-lg-5">
                <opensilex-InfrastructureFacilitySelector
                        label="Position.to"
                        :facilities.sync="form.to"
                        :multiple="false"
                        :required="false"
                        helpMessage="Position.to-help"
                ></opensilex-InfrastructureFacilitySelector>
            </div>
        </div>

        <div>
            <p><b> {{ $t("Position.title") }}</b></p>
            <hr/>
            <opensilex-PositionForm v-if="form.targets_positions && form.targets_positions[0]"
               :form.sync="form.targets_positions[0].position">
            </opensilex-PositionForm>
        </div>

    </ValidationObserver>
</template>

<script lang="ts">
    import {Component, Prop, Ref} from "vue-property-decorator";
    import Vue from "vue";
    import PositionForm from "../../positions/form/PositionForm.vue";
    // @ts-ignore
    import {MoveCreationDTO} from "opensilex-core/model/moveCreationDTO";
    import {TargetPositionCreationDTO} from "opensilex-core/model/targetPositionCreationDTO";

    @Component
    export default class MoveForm extends Vue {

        @Ref("validatorRef") readonly validatorRef!: any;

        editMode = false;

        @Prop({default: () => MoveForm.getEmptyForm()})
        form: MoveCreationDTO;

        static getEmptyTargetsPositions() : Array<TargetPositionCreationDTO> {
            return  [{
                    target: undefined,
                    position : PositionForm.getEmptyForm()
                }];
         }

        static getEmptyForm() : MoveCreationDTO{
            return {
              uri: undefined,
              rdf_type: undefined,
              start: undefined,
              end: undefined,
              is_instant: true,
              description: undefined,
              targets: [],

              relations: [],

              // move specific properties
                from: undefined,
                to: undefined,

                // move position(s)
              targets_positions: MoveForm.getEmptyTargetsPositions()
            };
        }

        getEmptyForm() {
            return MoveForm.getEmptyForm();
        }

        created(){
        }


        reset() {
            return this.validatorRef.reset();
        }

        validate() {
            return this.validatorRef.validate();
        }

    }
</script>

<i18n>
en:
    Move:
        add: Move
        location: Location
        uri-help: Move URI (autogenerated if empty)
        type-help: Move type
fr:
    Move:
        add: Déplacer
        location: Localisation
        uri-help: URI du déplacement (auto-générée si vide)
        type-help: Type de déplacement
</i18n>
