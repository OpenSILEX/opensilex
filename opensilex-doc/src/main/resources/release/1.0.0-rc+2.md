# Migrate to version 1.0.0-rc+2 from 1.0.0-rc+1

## Changes on the ontology

You are concerned about this change if you already have organizations and/or facilities.
In this version, some concepts of the ontology concerning the organizations have changed.
`vocabulary:Infrastructure` has become `foaf:Organization` and `vocabulary:InfrastructureFacility`
has become `vocabulary:Facility`. Two properties have also changed and need to be updated.

### SPARQL script to run

If you have organizations hosted by some facilities, and/or experiments associated with
at least one organization, then you will need to run the following script to update the properties :

```sparql
delete {
    graph <BASE_URI/set/infrastructures> {
        ?s ?p ?o
    }
} insert {
    graph <BASE_URI/set/infrastructures> {
        ?s <http://www.opensilex.org/vocabulary/oeso#isHosted> ?o
    }
} where {
    graph <BASE_URI/set/infrastructures> {
        ?s ?p ?o.
        values (?p) { (<http://www.opensilex.org/vocabulary/oeso#hasFacility>) }
    }
}

delete {
    graph <BASE_URI/set/experiments> {
        ?s ?p ?o
    }
} insert {
    graph <BASE_URI/set/experiments> {
        ?s <http://www.opensilex.org/vocabulary/oeso#usesOrganization> ?o
    }
} where {
    graph <BASE_URI/set/experiments> {
        ?s ?p ?o.
        values (?p) { (<http://www.opensilex.org/vocabulary/oeso#hasInfrastructure>) }
    }
}

delete {
  ?uri a <http://www.opensilex.org/vocabulary/oeso#InfrastructureFacility>
} insert {
  ?uri a <http://www.opensilex.org/vocabulary/oeso#Facility>
} where {
  ?uri a <http://www.opensilex.org/vocabulary/oeso#InfrastructureFacility>
}

delete {
  ?uri a <http://www.opensilex.org/vocabulary/oeso#Infrastructure>
} insert {
  ?uri a <http://xmlns.com/foaf/0.1/Organization>
} where {
  ?uri a <http://www.opensilex.org/vocabulary/oeso#Infrastructure>
}
```

Note that `BASE_URI` in this script should be replaced with the base URI of your instance.
For example, for Sixtine, this would be `http://sixtine.mistea.inrae.fr`.

### Specific ontology file changes

If you have a specific ontology file deployed to your instance, you will need to do
some checks :

- Subclasses of `vocabulary:Infrastructure` need to be marked as subclasses of `foaf:Organization` instead.
- Subclasses of `vocabulary:InfrastructureFacilities` need to be marked as subclasses of `vocabulary:Facilities` instead.
- If you have defined the following custom types, you need to remove them :
  - `vocabulary:Installation`
  - `vocabulary:ResearchUnit`
  - `vocabulary:ExperimentalUnit`